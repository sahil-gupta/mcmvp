{"version":3,"sources":["../../src/pages/welcome/welcome.module.ts","../../src/pages/welcome/welcome.ts"],"names":[],"mappings":"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","file":"0.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { TranslateModule } from '@ngx-translate/core';\nimport { IonicPageModule } from 'ionic-angular';\n\nimport { WelcomePage } from './welcome';\n\n@NgModule({\n  declarations: [\n    WelcomePage,\n  ],\n  imports: [\n    IonicPageModule.forChild(WelcomePage),\n    TranslateModule.forChild()\n  ],\n  exports: [\n    WelcomePage\n  ]\n})\nexport class WelcomePageModule { }\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/welcome/welcome.module.ts","import { Component } from '@angular/core';\nimport { IonicPage, NavController, ToastController } from 'ionic-angular';\n\nimport { AngularFireAuth } from 'angularfire2/auth';\nimport * as firebase from 'firebase/app';\nimport { Platform } from 'ionic-angular';\nimport { Facebook } from '@ionic-native/facebook';\n\nimport { MainPage } from '../pages';\n\n/**\n * The Welcome Page is a splash page that quickly describes the app,\n * and then directs the user to create an account or log in.\n * If you'd like to immediately put the user onto a login/signup page,\n * we recommend not using the Welcome page.\n*/\n@IonicPage()\n@Component({\n  selector: 'page-welcome',\n  templateUrl: 'welcome.html'\n})\nexport class WelcomePage {\n  // userProfile: any = null;\n\n  constructor(public navCtrl: NavController,\n              private afAuth: AngularFireAuth,\n              private fb: Facebook,\n              private platform: Platform,\n              public toastCtrl: ToastController) {\n    // afAuth.authState.subscribe((user: firebase.User) => {\n    //   if (!user) {\n    //     this.userProfile = null;\n    //     return;\n    //   }\n    //   this.userProfile = user;\n    // });\n  }\n\n  // guide https://github.com/angular/angularfire2/blob/master/docs/ionic/v3.md\n  signInWithFacebook() {\n    if (this.platform.is('cordova')) {\n      return this.fb.login(['email', 'public_profile'])\n      .then(res => {\n        const facebookCredential = firebase.auth.FacebookAuthProvider.credential(res.authResponse.accessToken);\n        return firebase.auth().signInWithCredential(facebookCredential)\n        .then(success => this.facebookSuccessTodo(success))\n        .catch(error => {\n          // 'auth/account-exists-with-different-credential'\n          console.log(JSON.stringify(error));\n\n          // let toast = this.toastCtrl.create({\n          //   message: 'So... this email exists with another account',\n          //   duration: 3000,\n          // });\n          // toast.present();\n        });\n      })\n      .catch(error => {\n        console.log('cancelled fb login');\n        console.log(JSON.stringify(error));\n      });\n    } else {\n      return this.afAuth.auth.signInWithPopup(new firebase.auth.FacebookAuthProvider())\n      .then(success => this.facebookSuccessTodo(success))\n      .catch(error => {\n        // 'auth/account-exists-with-different-credential'\n        console.log(JSON.stringify(error));\n\n        // let toast = this.toastCtrl.create({\n        //   message: 'So... this email exists with another account',\n        //   duration: 3000,\n        // });\n        // toast.present();\n      });\n    }\n  }\n\n  facebookSuccessTodo(success) {\n    console.log(\"facebook success\") // + JSON.stringify(success));\n    // console.log(JSON.stringify(success));\n    var uid;\n\n    if (success.user)\n      uid = success.user.uid;\n    else\n      uid = success.uid;\n\n    firebase.database().ref('users/' + uid).once('value', snapshot => {\n      if (snapshot.val()) { // existing user\n        console.log('repeat login');\n        this.navCtrl.push(MainPage);\n      } else { // new user\n        // add the init video to inbox\n        firebase.database().ref('usersvideos/' + uid).set({\n          0: 100\n        });\n\n        // manage mNumber data and additional info\n        firebase.database().ref('globals/mNumberLatest').once('value', snapshot => {\n          var mNumber = snapshot.val();\n          firebase.database().ref('globals/mNumberLatest').set(mNumber+1);\n\n          var p = success.additionalUserInfo.profile;\n          firebase.database().ref('users/' + uid).update({\n            gender: p.gender,\n            timezone: p.timezone,\n            link: p.link,\n            last_name: p.last_name,\n            first_name: p.first_name,\n            photoURL: success.user.photoURL,\n            mNumber: mNumber\n          });\n\n          this.navCtrl.push(MainPage);\n        });\n      }\n    });\n  }\n\n  tosignup() {\n    this.navCtrl.push('SignupPage');\n  }\n\n  quickload() {\n    this.navCtrl.push(MainPage);\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/welcome/welcome.ts"],"sourceRoot":""}